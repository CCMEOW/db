# MVCC

### MVCC是什么？
Multiversion concurrency control，即多版本并发控制。

### 解决什么问题？
解决数据库并发访问的问题。

数据库通常使用锁来实现隔离性。每次操作都加锁是对性能的浪费，因为很多应用是读多写少，因此出现读写锁：读共享，读写、写写互斥。而后对读写互斥进一步优化，则是MVCC，使读写不互斥。

### 实现的原理 [wiki](https://zh.wikipedia.org/wiki/%E5%A4%9A%E7%89%88%E6%9C%AC%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6)

MVCC使用时间戳 (TS), 或“自动增量的事务ID”实现“事务一致性”。MVCC可以确保每个事务(T)通常不必“读等待”数据库对象(P)。这通过对象有多个版本，每个版本有创建时间戳 与废止时间戳 (WTS)做到的。

事务Ti读取对象(P)时，只有比事务Ti的时间戳早，但是时间上最接近事务Ti的对象版本可见，且该版本应该没有被废止。

事务Ti写入对象P时，如果还有事务Tk要写入同一对象，则(Ti)必须早于(Tk)，即 (Ti) < (Tk)，才能成功。

MVCC可以无锁实现。
